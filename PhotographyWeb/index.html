<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RCC Photography — Guided Quote Journey</title>
  <meta name="description" content="Guided, animated quote + inquiry builder for RCC Photography with live pricing." />
  <meta name="theme-color" content="#c2a47d" />
  <style>
    :root {
      --bg: #faf8f6;
      --card: #ffffff;
      --text: #1a1a1a;
      --muted: #6b6b6b;
      --accent: #c2a47d;
      --accent-dark: #a7865f;
      --border: #e8e1d8;
    }

    .rcc-photo-quote * { box-sizing: border-box; }
    .rcc-photo-quote html, .rcc-photo-quote body { height: 100%; }
    .rcc-photo-quote body {
      margin: 0;
      font-family: 'Open Sans', sans-serif !important;
      color: #24272b !important;
      background: transparent;
    }
    .rcc-photo-quote header {
      padding: 0.1rem 0.1rem;
      text-align: center; }
    .rcc-photo-quote h1 {
      letter-spacing: .5px;
      margin: 0rem 0rem;
      font-size: clamp(1.5rem, 2.5vw, 2rem);
      color: #24272b !important;
      font-family: 'Open Sans', sans-serif !important;
      font-weight: normal !important;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote .tag {
      margin: 0.5rem 0rem 0rem;
      color: #24272b !important;
      font-size: 14px !important;
      font-family: 'Open Sans', sans-serif !important;
      font-weight: normal !important;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote .hidden { display: none !important; }
    .rcc-photo-quote .mt-2 { margin-top: .75rem; }
    .rcc-photo-quote .mt-3 { margin-top: .75rem; }
    .rcc-photo-quote .container {
      width: 100%;
      margin: auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0rem;
      align-items: start;
      max-width: 1600px;
      padding: 0rem;
      justify-content: center;
    }
    @media (max-width: 900px) {
      .rcc-photo-quote .container {
        grid-template-columns: 1fr;
      }
      .rcc-photo-quote .guided-steps, .rcc-photo-quote .estimate-sticky {
        margin: 1rem 0.5rem;
        max-width: 100%;
      }
    }
    .rcc-photo-quote .guided-steps {
      max-width: 800px;
      margin: 1rem 1rem;
      flex-direction: column;
    }
    .rcc-photo-quote .estimate-sticky {
      max-width: 800px;
      margin: 1rem 1rem;
      flex-direction: column;
    }
    .rcc-photo-quote .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,.04);
      padding: 2rem;
    }
    .rcc-photo-quote .stepper { display:flex; align-items:center; gap:.5rem; margin: .25rem 0 1rem; }
    .rcc-photo-quote .dot { width: 8px; height: 8px; border-radius:999px; background:#e9e1d6; transition: all .25s ease; }
    .rcc-photo-quote .dot.on { background: var(--accent); transform: scale(1.15); }
    .rcc-photo-quote .step-label { margin-left:.5rem; color:var(--muted); font-size:.95rem; }
    .rcc-photo-quote .slides { position: relative; min-height: 0; overflow: visible; }
    .rcc-photo-quote .slide { display: none; padding-top: .25rem; }
    .rcc-photo-quote .slide.active { display: block; }
    .rcc-photo-quote label {
      display: block;
      font-weight: normal !important;
      margin: .5rem 0 .35rem;
      color: #24272b !important;
      font-size: 14px !important;
      font-family: 'Open Sans', sans-serif !important;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote .hint {
      color: #24272b !important;
      font-size: 14px !important;
      font-family: 'Open Sans', sans-serif !important;
      font-weight: normal !important;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote input, .rcc-photo-quote select, .rcc-photo-quote textarea {
      width: 100%;
      padding: .7rem .8rem;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #fff;
      font-size: 14px !important;
      font-family: 'Open Sans', sans-serif !important;
      color: #24272b !important;
      font-weight: normal !important;
      white-space: pre-wrap !important;
      transition: box-shadow .2s ease, border-color .2s ease;
    }
    .rcc-photo-quote input:focus-visible, .rcc-photo-quote select:focus-visible, .rcc-photo-quote textarea:focus-visible { outline:none; border-color:var(--accent); box-shadow: 0 0 0 3px rgba(194,164,125,.15); }
    .rcc-photo-quote textarea{ min-height:110px; }
    .rcc-photo-quote .error-msg {
      color: #e57373;
      font-size: 1rem;
      font-weight: 600;
      margin: 1rem 0 0 0;
      text-align: center;
      display: block;
    }
    .rcc-photo-quote .missing-field {
      border: 2px solid #e57373 !important;
      box-shadow: 0 0 0 2px #e5737333;
    }
    .rcc-photo-quote .row{ display:grid; grid-template-columns:1fr 1fr; gap:.75rem; }
    .rcc-photo-quote .row-3{ display:grid; grid-template-columns: repeat(3,1fr); gap:.75rem; }
    @media (max-width: 640px) { .rcc-photo-quote .row, .rcc-photo-quote .row-3 { grid-template-columns: 1fr; } }
    .rcc-photo-quote .pill { display:inline-flex; align-items:center; gap:.5rem; padding:.45rem .75rem; border:1px solid var(--border); border-radius:999px; cursor:pointer; user-select:none; background:#fff; }
    .rcc-photo-quote .pill input{ width:auto; }
    .rcc-photo-quote .nav { display:flex; justify-content:space-between; gap:.5rem; margin-top:1rem; }
    .rcc-photo-quote .btn {
      appearance: none;
      border: 0;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: .5rem;
      padding: .85rem 1rem;
      border-radius: 12px;
      font-weight: normal !important;
      font-size: 14px !important;
      font-family: 'Open Sans', sans-serif !important;
      background: var(--accent);
      color: #fff;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote .btn:hover { background: var(--accent-dark); }
    .rcc-photo-quote .btn.secondary {
      background: #fff;
      color: #24272b !important;
      border: 1px solid var(--border);
    }
    .rcc-photo-quote .btn.ghost {
      background: transparent;
      border: 1px dashed var(--border);
      color: #24272b !important;
    }
    .rcc-photo-quote .section-title {
      margin: .25rem 0 .75rem;
      font-size: 1.1rem !important;
      color: #24272b !important;
      font-family: 'Open Sans', sans-serif !important;
      font-weight: normal !important;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote #journeyTitle.section-title {
      display: block;
      width: 100%;
      text-align: center;
      font-size: 2.2rem !important;
      font-weight: normal !important;
      color: #24272b !important;
      font-family: 'Open Sans', sans-serif !important;
      letter-spacing: 0.5px;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote .price { font-feature-settings:"tnum" on, "lnum" on; font-variant-numeric:tabular-nums; }
    .rcc-photo-quote .sum-line { display:flex; justify-content:space-between; margin:.35rem 0; }
    .rcc-photo-quote .sum-line.total { font-size:1.15rem; font-weight:800; }
    .rcc-photo-quote .hr { height:1px; background:var(--border); margin:.75rem 0; }
    .rcc-photo-quote .muted {
      color: #24272b !important;
      font-size: 14px !important;
      font-family: 'Open Sans', sans-serif !important;
      font-weight: normal !important;
      white-space: pre-wrap !important;
    }
    .rcc-photo-quote .badge { display:inline-block; padding:.15rem .5rem; border-radius:8px; background:#f3eee6; color:#7a5f3e; font-size:.8rem; font-weight:700; }
    .rcc-photo-quote .flash { animation: flash .4s ease; }
    @keyframes flash { from { background: #fff5e9; } to { background: transparent; } }
    .rcc-photo-quote .review-box {
      background: #faf7f2;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1rem 1rem;
      white-space: pre-wrap !important;
      font-family: 'Open Sans', sans-serif !important;
      font-size: 14px !important;
      color: #24272b !important;
      font-weight: normal !important;
      min-height: 180px;
      height: auto;
      max-height: none;
      overflow-y: auto;
      width: 100%;
      box-sizing: border-box;
    }
    .rcc-photo-quote .pkg-details { border: 1px dashed var(--border); border-radius: 12px; padding: .75rem; margin-top: .75rem; }
    .rcc-photo-quote .pkg-title { font-weight: 700; margin: 0 0 .25rem; font-size: 1rem; }
    .rcc-photo-quote .pkg-desc { margin: 0 0 .35rem; color: var(--muted); font-size: .95rem; }
    .rcc-photo-quote .pkg-includes { margin: 0; padding-left: 1.1rem; font-size: .95rem; }
    .rcc-photo-quote .pkg-includes li { margin: .15rem 0; }
    @media (prefers-reduced-motion: reduce) { .rcc-photo-quote .slide, .rcc-photo-quote .dot { transition: none; } }
  </style>
</head>
<body>
  <div class="rcc-photo-quote">
    <header>
      <h1>Build Your Photography Package</h1>
      <p class="tag" aria-label="brand tagline">RCC Photography • Guided journey • Live estimate</p>
    </header>

    <main class="container">
      <section class="guided-steps" aria-labelledby="journeyTitle">
        <div class="card">
          <div class="stepper" id="stepper" aria-hidden="true" aria-live="polite"></div>
          <h2 id="journeyTitle" class="section-title">Let's personalize your session</h2>
          <div class="slides" id="slides" role="group" aria-label="Quote builder steps">
            <div class="slide active" data-step="0">
              <p class="muted">Answer a few quick questions. You’ll see your estimate update on the right after each step. No payment collected here.</p>
              <div class="nav">
                <button class="btn" id="startBtn" type="button">Continue</button>
                <button class="btn secondary" id="resetBtn" type="button">Reset Quote</button>
              </div>
            </div>

            <div class="slide" data-step="1">
              <label for="service">What are we celebrating?</label>
              <select id="service" aria-label="Service type">
                <option value="">Select…</option>
              </select>
              <div class="nav">
                <button class="btn secondary" data-nav="prev" type="button">Back</button>
                <button class="btn" data-nav="next" type="button">Next</button>
              </div>
            </div>

            <div class="slide" data-step="2">
              <label for="package">Choose a package</label>
              <select id="package" aria-label="Package"></select>
              <div class="row mt-2">
                <div>
                  <label for="hours">Hours of coverage</label>
                  <input type="number" id="hours" min="1" step="1" inputmode="numeric" readonly disabled aria-readonly="true" />
                  <div class="hint">Package hours are fixed. Add extra time on the next step.</div>
                </div>
              </div>
              <div class="nav">
                <button class="btn secondary" data-nav="prev" type="button">Back</button>
                <button class="btn" data-nav="next" type="button">Next</button>
              </div>
            </div>

            <div class="slide" data-step="3">
              <p class="section-title" style="margin-top:.25rem;">Would you like any add‑ons?</p>
              <div class="row-3" id="addonsWrap"></div>
              <div class="row mt-2">
                <div>
                  <label for="extraHours">Extra hours</label>
                  <input type="number" id="extraHours" min="0" step="1" value="0" inputmode="numeric" />
                </div>
                <div>
                  <label for="additionalShoots">Additional shooters</label>
                  <input type="number" id="additionalShoots" min="0" step="1" value="0" inputmode="numeric" />
                  <div class="hint">Each additional shooter is charged per hour of coverage.</div>
                </div>
              </div>
              <div class="nav">
                <button class="btn secondary" data-nav="prev" type="button">Back</button>
                <button class="btn" data-nav="next" type="button">Next</button>
              </div>
            </div>
            <div class="slide" data-step="4">
              <h3 class="section-title">Review & send</h3>
              <p class="muted">Here’s a summary of your selections. You can go back to make changes.</p>
              <pre id="reviewBox" class="review-box" aria-live="polite"></pre>
              <div class="nav">
                <button class="btn secondary" data-nav="prev" type="button">Back</button>
                <button class="btn" id="btnCompose" type="button">Send Inquiry Email</button>
              </div>
            </div>
          </div>
          <div id="errorMsgContainer"></div>
        </div>
      </section>

      <aside class="estimate-sticky" aria-label="Live estimate">
        <div class="card">
          <h2 class="section-title">Estimate</h2>
          <div id="estimateBox">
            <!-- 1. Base Package -->
            <div class="sum-line"><span>Base package</span><span class="price" id="sumBase">$0</span></div>
            <div class="hr" role="separator" aria-hidden="true"></div>

            <!-- 2. Extra Hours + Additional Shooters -->
            <div class="sum-line"><span id="sumExtraHoursLabel">Extra hours</span><span class="price" id="sumExtraHours">$0</span></div>
            <div class="sum-line"><span id="sumShootersLabel">Additional shooters</span><span class="price" id="sumShooters">$0</span></div>
            <div class="hr" role="separator" aria-hidden="true"></div>

            <!-- 3. Add-ons -->
            <div class="sum-line">Add-ons</div>
            <div id="addonItems" class="mt-2" aria-live="polite"></div>

            <!-- 4. Total -->
            <div class="hr" role="separator" aria-hidden="true"></div>
            <div class="sum-line total"><span>Estimated total</span><span class="price" id="sumTotal">$0</span></div>

            <!-- 5. Package details -->
            <div class="hr" role="separator" aria-hidden="true"></div>
            <div id="pkgDetails" class="pkg-details hidden" aria-live="polite"></div>

            <!-- 6. All Packages -->
            <div id="pkgAllInclude" class="pkg-details" aria-live="polite">
              <p class="pkg-desc">Included in all packages:</p>
                <ul class="pkg-includes">
                  <li>Full-resolution online image gallery with unlimited downloads</li>
                  <li>Image printing service built into your online gallery</li>
                  <li>First 30 miles of travel</li>
                  <li>2-3 week gallery turnaround for sessions 2hrs or under</li>
                  <li>4-6 week gallery turnaround for sessions greater than 2hrs </li>
                </ul>
                <p class="muted mt-2">Taxes (if applicable) not included. This is intended to be used for price estimates only. Final proposals will be sent via email through Honeybook.</p>
            </div>
            </ul>
            </div>
        </div>
      </aside>
    </main>
  </div>

  <script>
    const CONFIG = {
      SERVICE_TYPE: [
        { id: "wedding", name: "Wedding", desc: "Full wedding day coverage and packages", hourlyRate: 300, hourlyRateShooter: 80, allowAdditionalShooters: true },
        { id: "engagement", name: "Engagement", desc: "Engagement sessions and packages", hourlyRate: 200, hourlyRateShooter: 80, allowAdditionalShooters: false },
        { id: "senior", name: "Senior", desc: "Senior portraits and packages", hourlyRate: 200, hourlyRateShooter: 80, allowAdditionalShooters: false },
        { id: "family", name: "Family", desc: "Family portraits and sessions", hourlyRate: 200, hourlyRateShooter: 80, allowAdditionalShooters: false },
        { id: "events", name: "Events", desc: "Event photography and coverage", hourlyRate: 300, hourlyRateShooter: 80, allowAdditionalShooters: true },
        { id: "maternity", name: "Maternity", desc: "Maternity portraits and sessions", hourlyRate: 200, hourlyRateShooter: 80, allowAdditionalShooters: false },
        { id: "newborn", name: "Newborn", desc: "Newborn portraits and sessions", hourlyRate: 200, hourlyRateShooter: 80, allowAdditionalShooters: false },
        { id: "brand", name: "Brand", desc: "Brand portraits and sessions", hourlyRate: 200, hourlyRateShooter: 80, allowAdditionalShooters: false }
      ],
      ADDONS: [
        { id: "album", name: "Heirloom Album Creation", price: 650, priceperhr: 0, priceperphoto: 0, pricemin: 0, pricemax: 0, services: ["wedding"] },
        { id: "engagement", name: "1-Hr Engagement Session", price: 550, priceperhr: 0, priceperphoto: 0, pricemin: 0, pricemax: 0, services: ["wedding"] },
        { id: "rush", name: "Rush Gallery Turnaround", price: 100, priceperhr: 0, priceperphoto: 0.5, pricemin: 150, pricemax: 950, services: [] },
        { id: "social", name: "Behind the Scenes + Social Media Coverage", price: 150, priceperhr: 50, priceperphoto: 0, pricemin: 0, pricemax: 950, services: [] },
        { id: "studio", name: "Studio Rental", price: 0, priceperhr: 80, priceperphoto: 0, pricemin: 0, pricemax: 0, services: ["family","maternity","senior","newborn","brand","engagement"] }
      ],
      PACKAGE: [
        { id: "fam1", type: "family", name: "Family Package I", hours: 1, price: 550, desc: "1-Hour Family photo session", includes: ["1-Hour Photo shoot", "75+ Images", "Up to 2 outfits at 1 location", "Outfit & planning guide"], photocount: 75 },
        { id: "fam2", type: "family", name: "Family Package II", hours: 0.5, price: 450, desc: "30-Minute Family photo session", includes: ["30-Minute Photo shoot", "45+ Images", "1 outfit at 1 location", "Outfit & planning guide"], photocount: 45 },
        { id: "mat1", type: "maternity", name: "Maternity Package I", hours: 1, price: 550, desc: "1-Hour Maternity photo session", includes: ["1-Hour Photo shoot", "75+ Images", "Up to 2 outfits at 1 location", "Outfit & planning guide"], photocount: 75 },
        { id: "mat2", type: "maternity", name: "Maternity Package II", hours: 0.5, price: 450, desc: "30-Minute Maternity photo session", includes: ["30-Minute Photo shoot", "45+ Images", "1 outfit at 1 location", "Outfit & planning guide"], photocount: 45 },
        { id: "new1", type: "newborn", name: "Newborn Package I", hours: 1, price: 550, desc: "1-Hour Newborn photo session", includes: ["1-Hour Photo shoot", "75+ Images", "Up to 2 outfits at 1 location", "Outfit & planning guide"], photocount: 75 },
        { id: "new2", type: "newborn", name: "Newborn Package II", hours: 0.5, price: 450, desc: "30-Minute Newborn photo session", includes: ["30-Minute Photo shoot", "45+ Images", "1 outfit at 1 location", "Outfit & planning guide"], photocount: 45 },
        { id: "sen1", type: "senior", name: "Senior Package I", hours: 2, price: 750, desc: "2-Hour Senior photo session", includes: ["2-Hour Photo shoot", "200+ Images", "Up to 5 outfits", "Outfit & planning guide"], photocount: 200 },
        { id: "sen2", type: "senior", name: "Senior Package II", hours: 1, price: 550, desc: "1-Hour Senior photo session", includes: ["1-Hour Photo shoot", "90+ Images", "Up to 2 outfits", "Outfit & planning guide"], photocount: 90 },
        { id: "sen3", type: "senior", name: "Senior Package III", hours: 0.5, price: 450, desc: "30-Minute Senior photo session", includes: ["30-Minute Photo shoot", "50+ Images", "1 outfit", "Outfit & planning guide"], photocount: 50 },
        { id: "eng1", type: "engagement", name: "Engagement  Package I", hours: 1, price: 550, desc: "1-Hour Engagement photo session", includes: ["1-Hour Photo shoot", "75+ Images", "Up to 2 outfits at 1 location", "Outfit & planning guide"], photocount: 75 },
        { id: "eng2", type: "engagement", name: "Engagement  Package II", hours: 0.5, price: 450, desc: "30-Minute Engagement photo session", includes: ["30-Minute Photo shoot", "45+ Images", "1 outfit at 1 location", "Outfit & planning guide"], photocount: 45 },
        { id: "wed1", type: "wedding", name: "Wedding Collection I", hours: 10, price: 3900, desc: "10-Hour day. Perfect for all-day weddings", includes: ["10-Hour of converage", "Timeline creation", "Consultation call", "Sneak peeks within 72 hours", "Wedding Guide"], photocount: 1000 },
        { id: "wed2", type: "wedding", name: "Wedding Collection II", hours: 8, price: 3450, desc: "8-Hour day. Ideal for most every wedding", includes: ["8-Hour of converage", "Timeline creation", "Consultation call", "Sneak peeks within 72 hours", "Wedding Guide"], photocount: 800 },
        { id: "wed3", type: "wedding", name: "Wedding Collection III", hours: 6, price: 3000, desc: "6-Hour day. Best for a half-day, laid back wedding", includes: ["6-Hour of converage", "Timeline creation", "Consultation call", "Sneak peeks within 72 hours", "Wedding Guide"], photocount: 600 },
        { id: "wed4", type: "wedding", name: "Microwedding", hours: 4, price: 2550, desc: "4-Hour day. Great for a small ceremonies", includes: ["4-Hour of converage", "Timeline creation", "Consultation call", "Sneak peeks within 72 hours", "Wedding Guide"], photocount: 400 },
        { id: "evt1", type: "events", name: "Event - Half Day", hours: 4, price: 1500, desc: "4-Hour Event photo coverage", includes: ["4-Hour of converage"], photocount: 300 },
        { id: "bnd1", type: "brand", name: "Personal Brand Package I", hours: 3, price: 975, desc: "2-3 Hour Personal Brand session", includes: ["2-3 Hours of converage","2-3 locations","3-5 outfits + outfit guide","Collaborated mood board + questionnaire","Professional hair + makeup styling"], photocount: 300 },
        { id: "bnd2", type: "brand", name: "Personal Brand Package II", hours: 1.5, price: 650, desc: "4-Hour Event photo coverage", includes: ["1.5 Hours of converage","1 location","2-3 outfits + outfit guide","Collaborated mood board + questionnaire"], photocount: 150 }
      ]
    };

    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));
    const fmt = n => (Number(n) || 0).toLocaleString(undefined, { style: 'currency', currency: 'USD' });
    const num = v => isNaN(+v) ? 0 : +v;

    const els = {
      // Elements
      slides: $('#slides'),
      stepper: $('#stepper'),
      startBtn: $('#startBtn'),
      nextBtn: document.querySelector('.btn[data-nav="next"]'),
      prevBtn: document.querySelector('.btn[data-nav="prev"]'),
      btnCompose: $('#btnCompose'),
      btnCopy: $('#btnCopy'),
      resetBtn: $('#resetBtn'),
      errorMsgContainer: $('#errorMsgContainer'),

      // Form fields Step 1
      service: $('#service'),

      // Form fields Step 2
      pkg: $('#package'),
      hours: $('#hours'),
      
      // Form fields Step 3
      addonItems: $('#addonItems'),
      addonsWrap: document.getElementById('addonsWrap'),
      extraHours: $('#extraHours'),
      additionalShoots: $('#additionalShoots'),
      
      // Form fields Step 4
      reviewBox: $('#reviewBox'),

      // Estimate totals
      sumBase: $('#sumBase'),
      sumExtraHours: $('#sumExtraHours'),
      sumShooters: $('#sumShooters'),
      sumAddons: $('#sumAddons'),
      sumTotal: $('#sumTotal'),

      // Package details
      pkgDetails: $('#pkgDetails'),
      retainerNote: $('#retainerNote')
    };

    // Cache keys
    const CACHE_KEY = 'rccPhotoQuoteProgress';

    // Save progress to localStorage
    function saveProgress() {
      const progressData = {
        service: els.service.value,
        pkg: els.pkg.value,
        hours: els.hours.value,
        extraHours: els.extraHours.value,
        addons: {}
      };
      // Save add-on checkboxes
      CONFIG.ADDONS.forEach(addon => {
        const input = document.getElementById(addon.id);
        if (input && input.type === 'checkbox') {
          progressData.addons[addon.id] = input.checked;
        }
      });
      localStorage.setItem(CACHE_KEY, JSON.stringify(progressData));
    }

    // Reset all selections and start from scratch
    function resetQuote() {
      localStorage.removeItem(CACHE_KEY);
      // Uncheck all add-ons
      CONFIG.ADDONS.forEach(addon => {
        const input = document.getElementById(addon.id);
        if (input && input.type === 'checkbox') {
          input.checked = false;
        }
      });
      // Clear all form fields
      els.additionalShoots.value = '0';
      els.extraHours.value = '0';
      els.pkg.value = '';
      els.service.value = '';

      go(0);
      compute();
      updateNavButtons();
    }

    // Restore progress from localStorage
    function restoreProgress() {
      const raw = localStorage.getItem(CACHE_KEY);
      if (!raw) return;
      try {
        // Restore all form fields
        const progressData = JSON.parse(raw);
        if (progressData.service) els.service.value = progressData.service;
        loadPackages();
        if (progressData.pkg) els.pkg.value = progressData.pkg;
        if (progressData.hours) els.hours.value = progressData.hours;
        if (progressData.extraHours) els.extraHours.value = progressData.extraHours;
        // Restore add-on checkboxes
        renderAddons();
        if (progressData.addons) {
          Object.keys(progressData.addons).forEach(key => {
            const input = document.getElementById(key);
            if (input && input.type === 'checkbox') {
              input.checked = progressData.addons[key];
            }
          });
        }
        compute();
        updateNavButtons();
      } catch(e) {
      }
    }

    let currentStep = 0;
    const lastStep = 4;
    
    // Drawing the stepper dots
    function renderStepper() {
      els.stepper.innerHTML = '';
      for (let i = 0; i <= lastStep; i++) {
        const d = document.createElement('div');
        d.className = 'dot' + (i <= currentStep ? ' on' : '');
        els.stepper.appendChild(d);
      }
      const lbl = document.createElement('span');
      lbl.className = 'step-label';
      lbl.textContent = `Step ${Math.min(currentStep, lastStep)}/${lastStep}`;
      els.stepper.appendChild(lbl);
    }

    // Go to a step
    function go(step) {
      clearErrorMsg();
      currentStep = Math.max(0, Math.min(step, lastStep));
      $$('.slide').forEach(s => s.classList.remove('active'));
      const nextStep = document.querySelector(`.slide[data-step="${currentStep}"]`);
      if (nextStep) nextStep.classList.add('active');
      renderStepper();
      if (currentStep === lastStep) {
        els.reviewBox.textContent = summaryText();
      }
    }

    function loadPackages() {
      const svc = els.service.value;
      const pkglist = CONFIG.PACKAGE.filter(p => p.type === svc);
      els.pkg.innerHTML = '';
      els.pkg.disabled = false;
      const blankOpt = document.createElement('option');
      blankOpt.value = '';
      blankOpt.textContent = 'Select one';
      blankOpt.disabled = false;
      blankOpt.selected = true;
      els.pkg.appendChild(blankOpt);
      pkglist.forEach(p => {
        const o = document.createElement('option');
        o.value = p.id;
        o.textContent = `${p.name} — ${p.hours} hr${p.hours !== 1 ? 's' : ''}`;
        o.dataset.hours = p.hours; o.dataset.price = p.price;
        els.pkg.appendChild(o);
      });
      els.pkg.value = '';
      els.hours.value = '';
      renderPackageDetails(null);
    }

    function renderPackageDetails(pkg) {
      if (!els.pkgDetails) return;
      if (!pkg) { els.pkgDetails.classList.add('hidden'); els.pkgDetails.innerHTML = ''; return; }
      els.pkgDetails.classList.remove('hidden');
      const items = (pkg.includes || []).map(i => `<li>${i}</li>`).join('');
      els.pkgDetails.innerHTML = `
        <h3 class="pkg-title">${pkg.name}</h3>
        <p class="pkg-desc">${pkg.desc || ''}</p>
        ${items ? `<ul class="pkg-includes">${items}</ul>` : ''}
      `;
    }

    function renderAddons() {
      const svc = els.service.value;
      if (!els.addonsWrap) return;
      els.addonsWrap.innerHTML = '';
      CONFIG.ADDONS.forEach(addon => {
        if (!addon.services || !addon.services.includes(svc)) return;
        const label = document.createElement('label');
        label.className = 'pill';
        label.innerHTML = `<input type="checkbox" id="${addon.id}"> <span>${addon.name}</span>`;
        els.addonsWrap.appendChild(label);
      });
    }

    function compute() {

      // Load package details and hours
      const svc = els.service.value;
      const pkglist = CONFIG.PACKAGE.filter(p => p.type === svc);
      let pkg = null;
      if (els.pkg.selectedIndex > 0) {
        pkg = pkglist[els.pkg.selectedIndex - 1];
      }
      if (pkg) {
        renderPackageDetails(pkg);
        els.hours.value = pkg.hours;
      } else {
        renderPackageDetails(null);
        els.hours.value = '';
      }

      // Hide/show Additional Shooters field based on CONFIG
      const svcObj = CONFIG.SERVICE_TYPE.find(s => s.id === svc);
      if (els.additionalShoots) {
        // Find the parent div for the field (label + input + hint)
        const shootersFieldDiv = els.additionalShoots.closest('div');
        if (svcObj && svcObj.allowAdditionalShooters) {
          els.additionalShoots.disabled = false;
          if (shootersFieldDiv) shootersFieldDiv.style.display = '';
        } else {
          els.additionalShoots.disabled = true;
          els.additionalShoots.value = '0';
          if (shootersFieldDiv) shootersFieldDiv.style.display = 'none';
        }
      }

      // Hide/show Additional Shooters sum line in Estimate card
      const shootersSumLine = document.getElementById('sumShootersLabel')?.closest('.sum-line');
      if (shootersSumLine) {
        if (svcObj && svcObj.allowAdditionalShooters) {
          shootersSumLine.style.display = '';
        } else {
          shootersSumLine.style.display = 'none';
        }
      }

      // Pricing calculations
      const basePrice = pkg ? num(pkg.price) : 0;
      const baseHours = pkg ? num(pkg.hours) : 0;
      const extraHours = Math.max(0, num(els.extraHours.value));
      const hourly = svcObj?.hourlyRate ?? 200;
      const hoursExtraBase = extraHours * hourly;
      const totalhours = baseHours + extraHours;
      if (els.sumBase) els.sumBase.textContent = fmt(basePrice);
      if (els.sumExtraHours) els.sumExtraHours.textContent = fmt(hoursExtraBase);
      // Update Extra Hours label dynamically
      const extraHoursLabel = document.getElementById('sumExtraHoursLabel');
      if (extraHoursLabel) {
        extraHoursLabel.textContent = `Extra hours${extraHours > 0 ? ` (${extraHours})` : ''}`;
      }

      // Additional Shooters calculation
      let shootersTotal = 0;
      let shooterHours = baseHours + extraHours;
      let shooterCostPerHr = svcObj?.hourlyRateShooter ?? 100;
      let additionalShooters = Math.max(0, num(els.additionalShoots.value));
      shootersTotal = additionalShooters > 0 ? shooterHours * shooterCostPerHr * additionalShooters : 0;
      if (typeof els.sumShooters !== 'undefined' && els.sumShooters) {
        els.sumShooters.textContent = fmt(shootersTotal);
        const shootersLabel = document.getElementById('sumShootersLabel');
        if (shootersLabel) {
          shootersLabel.textContent = `Additional shooters${additionalShooters > 0 ? ` (${additionalShooters} × ${shooterHours} hr${shooterHours !== 1 ? 's' : ''})` : ''}`;
        }
      }
      
      // Only include add-ons that are available for the selected service
      let addonsTotal = 0;
      let addonItems = [];
      CONFIG.ADDONS.forEach(addon => {
        if (!addon.services || !addon.services.includes(svc)) return;
        const input = document.getElementById(addon.id);
        if (!input || !input.checked) return;
        // Calculate add-on price: fixed + per-photo + per-hour
        let addonPrice = 0;
        addonPrice += addon.price || 0;
        addonPrice += (pkg?.photocount || 0) * (addon.priceperphoto || 0);
        addonPrice += (Math.ceil(totalhours) || 0) * (addon.priceperhr || 0);
        addonsTotal += addonPrice;
        addonItems.push({ name: addon.name, price: addonPrice });
      });
      // Add-on items list
      if (els.addonItems) {
        if (addonItems.length > 0) {
          els.addonItems.innerHTML = addonItems.map(item => `<div class="sum-line"><span>${item.name}</span><span class="price">${fmt(item.price)}</span></div>`).join('');
        } else {
          els.addonItems.innerHTML = '';
        }
      }
      if (els.sumAddons) els.sumAddons.textContent = fmt(addonsTotal);

      // Update total estimate
      const estimateTotal = num(basePrice) + num(hoursExtraBase) + num(shootersTotal) + num(addonsTotal);
      if (els.sumTotal) els.sumTotal.textContent = fmt(estimateTotal);
    }

    // Generate summary of selections for review box
    function summaryText() {
      // Pull information from Estimate card
      let lines = [];

      // Base Package
      const pkgOption = els.pkg.options[els.pkg.selectedIndex]?.textContent || '';
      lines.push(`Base Package: ${pkgOption}`);

      // Extra hours (only if selected and > 0)
      const extraHours = parseFloat(els.extraHours?.value || '0');
      if (extraHours > 0) {
        const extraHoursLabel = document.getElementById('sumExtraHoursLabel')?.textContent || 'Extra hours';
        const extraHoursValue = els.sumExtraHours?.textContent || '';
        lines.push(`${extraHoursLabel}: ${extraHoursValue}`);
      }

      // Additional shooters (only if selected and > 0)
      const additionalShooters = parseFloat(els.additionalShoots?.value || '0');
      if (additionalShooters > 0) {
        const shootersLabel = document.getElementById('sumShootersLabel')?.textContent || 'Additional shooters';
        const shootersValue = els.sumShooters?.textContent || '';
        lines.push(`${shootersLabel}: ${shootersValue}`);
      }

      // Add-ons (only if any selected, no header if none)
      const addonItems = Array.from(document.querySelectorAll('#addonItems .sum-line'));
      if (addonItems.length > 0) {
        addonItems.forEach(item => {
          const name = item.querySelector('span:first-child')?.textContent || '';
          const price = item.querySelector('span.price')?.textContent || '';
          lines.push(`Add-on ${name}: ${price}`);
        });
      }

      // Estimated total
      const totalValue = els.sumTotal?.textContent || '';
      lines.push(`Estimated total: ${totalValue}`);
      return lines.join('\n');
    }

    // Validation logic for each step. Checks if required fields are filled before allowing navigation.
    function validateStep(step) {
      switch (step) {
        case 1:
          return els.service.value !== '';
        case 2:
          // Only require package selection, not hours or index
          return els.pkg.value !== '';
        default:
          return true;
      }
    }

    function updateNavButtons() {
      document.querySelectorAll('.slide').forEach((slide, idx) => {
        const nextBtn = slide.querySelector('[data-nav="next"]');
        if (nextBtn) {
          nextBtn.disabled = false; // Always enabled
        }
      });
    }

    // Event listeners for navigation and form changes
    document.addEventListener('change', (e) => {
      // Handle service selection change
      if (e.target === els.service) {
        loadPackages();
        renderAddons();
      }
      compute();
      updateNavButtons();
      saveProgress();
    }, true);

    // Helper to show/hide error message below slides
    function showErrorMsg(step) {
      const container = document.getElementById('errorMsgContainer');
      if (!container) return;
      container.innerHTML = '<span class="error-msg">Missing required fields</span>';

      // Highlight missing fields for current step
      // Remove previous highlights
      document.querySelectorAll('.missing-field').forEach(el => {
        el.classList.remove('missing-field');
      });
      switch (step) {
        case 1:
          if (!els.service.value) els.service.classList.add('missing-field');
          break;
        case 2:
          if (!els.pkg.value) els.pkg.classList.add('missing-field');
          break;
      }
    }
    function clearErrorMsg() {
      const container = document.getElementById('errorMsgContainer');
      if (container) container.innerHTML = '';
      // Remove missing field highlights
      document.querySelectorAll('.missing-field').forEach(el => {
        el.classList.remove('missing-field');
      });
    }

    document.addEventListener('click', (e) => {
      const nav = e.target.closest('[data-nav]');
      if (nav && nav.getAttribute('data-nav') === 'next') {
        if (!validateStep(currentStep)) {
          showErrorMsg(currentStep);
          return;
        } else {
          go(currentStep + 1);
          updateNavButtons();
          return;
        }
      }
      if (nav) {
        const dir = nav.getAttribute('data-nav');
        go(dir === 'next' ? currentStep + 1 : currentStep - 1);
        updateNavButtons();
      }
    });

    // Start button to begin the journey
    els.startBtn?.addEventListener('click', () => { go(1); updateNavButtons(); });

    // Reset button to clear all selections
    document.getElementById('resetBtn')?.addEventListener('click', resetQuote);

    // Populate service dropdown from CONFIG.SERVICE_TYPE
    function populateServiceDropdown() {
      const select = document.getElementById('service');
      if (!select) return;
      // Remove all except first option
      select.innerHTML = '<option value="">Select…</option>';
      CONFIG.SERVICE_TYPE.forEach(svc => {
        const opt = document.createElement('option');
        opt.value = svc.id;
        opt.textContent = svc.name;
        opt.title = svc.desc;
        select.appendChild(opt);
      });
    }

    // Generate summary text for email
    document.addEventListener('click', (e) => {
      if (e.target.id === 'btnCompose') {
        // Save summary to localStorage and redirect to inquire.html
        localStorage.setItem('photoSummary', summaryText());
        window.location.href = 'Inquire.html';
      }
    });

    // Initial state
    populateServiceDropdown();
    restoreProgress();
    updateNavButtons();
    renderStepper();
    compute();
  </script>
</body>
</html>